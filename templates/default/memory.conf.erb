# CHEF MANAGED FILE: DO NOT EDIT
# Controlling Cookbook: <%= @cookbook_name %>
#

type: agent.memory
label: Memory
disabled: <%= @disabled %>
period: <%= @period %>
timeout: <%= @timeout %>
<% if @alarm == true %>
alarms:
    alarm-memory:
        label: Memory Usage
        notification_plan_id: <%= @notification_plan_id %>
        criteria: |
            if (percentage(metric['actual_used'], metric['total']) > <%= @crit %> ) {
              return new AlarmStatus(CRITICAL, "Memory usage is above your critical threshold of <%= @crit %>%");
            }
            if (percentage(metric['actual_used'], metric['total']) > <%= @warn %> ) {
              return new AlarmStatus(WARNING, "Memory usage is above your warning threshold of <%= @warn %>%");
            }
            return new AlarmStatus(OK, "Memory usage is below your warning threshold of <%= @warn %>%");
<% end %>
